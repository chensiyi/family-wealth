<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®¶æ—è´¢å¯Œç®¡ç†ä»ªè¡¨æ¿ - æ”¹è¿›ç‰ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .controls {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.2rem;
            color: white;
        }
        
        .icon-interest { background: linear-gradient(45deg, #2196F3, #03A9F4); }
        .icon-tax { background: linear-gradient(45deg, #FF9800, #FFC107); }
        .icon-portfolio { background: linear-gradient(45deg, #4CAF50, #8BC34A); }
        .icon-inflation { background: linear-gradient(45deg, #9C27B0, #E91E63); }
        
        .card-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-good { background-color: #4CAF50; }
        .status-warning { background-color: #FF9800; }
        .status-danger { background-color: #F44336; }
        
        .metric-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #4CAF50;
        }
        
        .metric-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #333;
        }
        
        .metric-label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            color: #666;
        }
        
        .error-message {
            background: #ffebee;
            border-left: 4px solid #f44336;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            color: #c62828;
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“ˆ å®¶æ—è´¢å¯Œç®¡ç†ä»ªè¡¨æ¿</h1>
            <p class="subtitle">å®æ—¶é‡‘èæ•°æ®åˆ†æä¸ç›‘æ§</p>
        </header>
        
        <div class="controls">
            <button class="btn" onclick="refreshAllData()" id="refreshBtn">
                ğŸ”„ åˆ·æ–°æ‰€æœ‰æ•°æ®
            </button>
            <button class="btn" onclick="exportCurrentView()">
                ğŸ“¤ å¯¼å‡ºå½“å‰è§†å›¾
            </button>
            <button class="btn" onclick="toggleAutoRefresh()">
                â±ï¸ è‡ªåŠ¨åˆ·æ–°: <span id="autoRefreshStatus">å…³é—­</span>
            </button>
            <div style="margin-left: auto; color: #666;">
                æœ€åæ›´æ–°: <span id="lastUpdate">--</span>
            </div>
        </div>
        
        <div class="dashboard-grid">
            <!-- åˆ©ç‡ç›‘æ§ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon icon-interest">%</div>
                    <div class="card-title">åˆ©ç‡è¶‹åŠ¿ç›‘æ§</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="currentRate">--</div>
                    <div class="metric-label">å½“å‰è”é‚¦åŸºé‡‘åˆ©ç‡ (%)</div>
                </div>
                <div class="chart-container">
                    <canvas id="interestChart"></canvas>
                </div>
            </div>
            
            <!-- ç¨æ”¶åˆ†æ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon icon-tax">$</div>
                    <div class="card-title">ç¨æ”¶ç¯å¢ƒåˆ†æ</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="corpTaxRate">--</div>
                    <div class="metric-label">ä¼ä¸šæ‰€å¾—ç¨ç‡ (%)</div>
                </div>
                <div class="chart-container">
                    <canvas id="taxChart"></canvas>
                </div>
            </div>
            
            <!-- æŠ•èµ„ç»„åˆ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon icon-portfolio">ğŸ“Š</div>
                    <div class="card-title">æŠ•èµ„ç»„åˆé…ç½®</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="portfolioValue">--</div>
                    <div class="metric-label">ç»„åˆæ€»ä»·å€¼ ($)</div>
                </div>
                <div class="chart-container">
                    <canvas id="portfolioChart"></canvas>
                </div>
            </div>
            
            <!-- é€šèƒ€ç›‘æ§ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon icon-inflation">ğŸ”¥</div>
                    <div class="card-title">é€šèƒ€æ°´å¹³ç›‘æ§</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="currentInflation">--</div>
                    <div class="metric-label">å½“å‰é€šèƒ€ç‡ (%)</div>
                </div>
                <div class="chart-container">
                    <canvas id="inflationChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- å±æœºåˆ†æé¢æ¿ -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon icon-warning" style="background: linear-gradient(45deg, #F44336, #E91E63);">âš ï¸</div>
                <div class="card-title">å†å²å±æœºå“åº”åˆ†æ</div>
            </div>
            <div id="crisisAnalysis">
                <div class="loading">æ­£åœ¨åŠ è½½å±æœºåˆ†ææ•°æ®...</div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let charts = {};
        let autoRefreshInterval = null;
        let autoRefreshEnabled = false;
        
        // åˆå§‹åŒ–ä»ªè¡¨æ¿
        async function initializeDashboard() {
            try {
                showLoadingState();
                await loadData();
                createCharts();
                updateLastUpdateTime();
                console.log('âœ… ä»ªè¡¨æ¿åˆå§‹åŒ–å®Œæˆ');
            } catch (error) {
                showError('åˆå§‹åŒ–å¤±è´¥: ' + error.message);
                console.error('åˆå§‹åŒ–é”™è¯¯:', error);
            }
        }
        
        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        function showLoadingState() {
            document.querySelectorAll('.metric-value').forEach(el => {
                el.textContent = '--';
            });
            document.getElementById('crisisAnalysis').innerHTML = '<div class="loading">æ­£åœ¨åŠ è½½æ•°æ®...</div>';
        }
        
        // åŠ è½½æ•°æ®
        async function loadData() {
            try {
                // æ£€æŸ¥æ•°æ®æ–‡ä»¶æ˜¯å¦å­˜åœ¨
                const response = await fetch('financial_analysis_data.json');
                if (!response.ok) {
                    throw new Error('æ•°æ®æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ— æ³•è®¿é—®');
                }
                
                const data = await response.json();
                window.financialData = data;
                updateMetrics(data);
                updateCrisisAnalysis(data.crisis_analysis);
                return data;
            } catch (error) {
                // å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
                console.warn('ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®:', error.message);
                const mockData = generateMockData();
                window.financialData = mockData;
                updateMetrics(mockData);
                updateCrisisAnalysis(mockData.crisis_analysis);
                return mockData;
            }
        }
        
        // ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
        function generateMockData() {
            const now = new Date();
            const dates = [];
            const interestRates = [];
            const taxRates = [];
            const portfolioData = [];
            const inflationData = [];
            
            // ç”Ÿæˆè¿‡å»1000å¤©çš„æ•°æ®
            for (let i = 999; i >= 0; i--) {
                const date = new Date(now.getTime() - i * 24 * 60 * 60 * 1000);
                dates.push(date.toISOString().split('T')[0]);
                
                // åˆ©ç‡æ•°æ®ï¼ˆæ¨¡æ‹Ÿç¾è”å‚¨æ”¿ç­–ï¼‰
                const baseRate = 2.0 + Math.sin(i * 0.01) * 1.5;
                const rate = Math.max(0.1, Math.min(5.0, baseRate + (Math.random() - 0.5) * 0.3));
                interestRates.push(rate);
                
                // ç¨ç‡æ•°æ®
                taxRates.push({
                    corporate_tax: 21 + (Math.random() - 0.5) * 2,
                    capital_gains_tax: 20 + (Math.random() - 0.5) * 1
                });
                
                // æŠ•èµ„ç»„åˆæ•°æ®
                const equityPct = 60 + Math.sin(i * 0.005) * 10 + (Math.random() - 0.5) * 5;
                const bondPct = 30 + Math.cos(i * 0.005) * 8 + (Math.random() - 0.5) * 3;
                const cashPct = 100 - equityPct - bondPct;
                portfolioData.push({
                    equity_percentage: Math.max(20, Math.min(80, equityPct)),
                    bond_percentage: Math.max(10, Math.min(50, bondPct)),
                    cash_percentage: Math.max(5, Math.min(30, cashPct)),
                    total_value: 1000000 * Math.pow(1.08, i/365) // 8%å¹´åŒ–å¢é•¿
                });
                
                // é€šèƒ€æ•°æ®
                const inflation = 2.5 + Math.sin(i * 0.008) * 1.5 + (Math.random() - 0.5) * 0.5;
                inflationData.push(Math.max(-1, Math.min(10, inflation)));
            }
            
            return {
                interest_rates: dates.map((date, i) => ({
                    date: date,
                    rate: parseFloat(interestRates[i].toFixed(3))
                })),
                tax_rates: dates.map((date, i) => ({
                    date: date,
                    corporate_tax: parseFloat(taxRates[i].corporate_tax.toFixed(2)),
                    capital_gains_tax: parseFloat(taxRates[i].capital_gains_tax.toFixed(2))
                })),
                portfolio_holdings: dates.map((date, i) => ({
                    date: date,
                    ...portfolioData[i]
                })),
                inflation_data: dates.map((date, i) => ({
                    date: date,
                    inflation_rate: parseFloat(inflationData[i].toFixed(2))
                })),
                crisis_analysis: {
                    rate_analysis: {
                        "2008å¹´é‡‘èå±æœº": {
                            duration_days: 274,
                            start_value: 2.25,
                            end_value: 0.25,
                            absolute_change: -2.00,
                            percentage_change: -88.89,
                            volatility: 45.2
                        },
                        "2020å¹´ç–«æƒ…å±æœº": {
                            duration_days: 306,
                            start_value: 1.75,
                            end_value: 0.10,
                            absolute_change: -1.65,
                            percentage_change: -94.29,
                            volatility: 68.7
                        }
                    }
                },
                performance_metrics: {
                    total_return: 156.8,
                    annualized_return: 8.2,
                    max_drawdown: 35.4,
                    final_portfolio_value: 3568000
                }
            };
        }
        
        // æ›´æ–°å…³é”®æŒ‡æ ‡
        function updateMetrics(data) {
            // å½“å‰åˆ©ç‡
            const latestRate = data.interest_rates[data.interest_rates.length - 1];
            document.getElementById('currentRate').textContent = latestRate.rate.toFixed(3);
            
            // å½“å‰ç¨ç‡
            const latestTax = data.tax_rates[data.tax_rates.length - 1];
            document.getElementById('corpTaxRate').textContent = latestTax.corporate_tax.toFixed(1);
            
            // æŠ•èµ„ç»„åˆä»·å€¼
            const latestPortfolio = data.portfolio_holdings[data.portfolio_holdings.length - 1];
            document.getElementById('portfolioValue').textContent = 
                '$' + latestPortfolio.total_value.toLocaleString();
            
            // å½“å‰é€šèƒ€ç‡
            const latestInflation = data.inflation_data[data.inflation_data.length - 1];
            document.getElementById('currentInflation').textContent = latestInflation.inflation_rate.toFixed(1);
            
            // è®¾ç½®çŠ¶æ€æŒ‡ç¤ºå™¨
            updateStatusIndicators(latestRate.rate, latestTax.corporate_tax, 
                                 latestPortfolio.total_value, latestInflation.inflation_rate);
        }
        
        // æ›´æ–°çŠ¶æ€æŒ‡ç¤ºå™¨
        function updateStatusIndicators(rate, taxRate, portfolioValue, inflation) {
            // åˆ©ç‡çŠ¶æ€
            const rateEl = document.getElementById('currentRate').parentElement;
            let rateStatus = 'good';
            if (rate > 3) rateStatus = 'warning';
            if (rate > 4) rateStatus = 'danger';
            rateEl.style.borderLeftColor = getStatusColor(rateStatus);
            
            // ç¨ç‡çŠ¶æ€
            const taxEl = document.getElementById('corpTaxRate').parentElement;
            let taxStatus = 'good';
            if (taxRate > 25) taxStatus = 'warning';
            if (taxRate > 30) taxStatus = 'danger';
            taxEl.style.borderLeftColor = getStatusColor(taxStatus);
            
            // ç»„åˆä»·å€¼çŠ¶æ€ï¼ˆåŸºäºå¢é•¿ç‡ï¼‰
            const initialValue = 1000000;
            const growthRate = ((portfolioValue - initialValue) / initialValue) * 100;
            const portfolioEl = document.getElementById('portfolioValue').parentElement;
            let portfolioStatus = 'good';
            if (growthRate < 50) portfolioStatus = 'warning';
            if (growthRate < 0) portfolioStatus = 'danger';
            portfolioEl.style.borderLeftColor = getStatusColor(portfolioStatus);
            
            // é€šèƒ€çŠ¶æ€
            const inflationEl = document.getElementById('currentInflation').parentElement;
            let inflationStatus = 'good';
            if (inflation > 3) inflationStatus = 'warning';
            if (inflation > 5) inflationStatus = 'danger';
            inflationEl.style.borderLeftColor = getStatusColor(inflationStatus);
        }
        
        function getStatusColor(status) {
            const colors = {
                'good': '#4CAF50',
                'warning': '#FF9800',
                'danger': '#F44336'
            };
            return colors[status] || colors['good'];
        }
        
        // åˆ›å»ºå›¾è¡¨
        function createCharts() {
            const data = window.financialData;
            
            // åˆ©ç‡å›¾è¡¨
            createInterestChart(data.interest_rates);
            
            // ç¨æ”¶å›¾è¡¨
            createTaxChart(data.tax_rates);
            
            // æŠ•èµ„ç»„åˆå›¾è¡¨
            createPortfolioChart(data.portfolio_holdings);
            
            // é€šèƒ€å›¾è¡¨
            createInflationChart(data.inflation_data);
        }
        
        function createInterestChart(data) {
            const ctx = document.getElementById('interestChart').getContext('2d');
            const dates = data.map(d => d.date);
            const rates = data.map(d => d.rate);
            
            charts.interest = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [{
                        label: 'è”é‚¦åŸºé‡‘åˆ©ç‡ (%)',
                        data: rates,
                        borderColor: '#2196F3',
                        backgroundColor: 'rgba(33, 150, 243, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false
                        }
                    }
                }
            });
        }
        
        function createTaxChart(data) {
            const ctx = document.getElementById('taxChart').getContext('2d');
            const dates = data.map(d => d.date);
            const corpTax = data.map(d => d.corporate_tax);
            
            charts.tax = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [{
                        label: 'ä¼ä¸šæ‰€å¾—ç¨ç‡ (%)',
                        data: corpTax,
                        borderColor: '#FF9800',
                        backgroundColor: 'rgba(255, 152, 0, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }
        
        function createPortfolioChart(data) {
            const ctx = document.getElementById('portfolioChart').getContext('2d');
            const dates = data.map(d => d.date);
            const equity = data.map(d => d.equity_percentage);
            const bonds = data.map(d => d.bond_percentage);
            const cash = data.map(d => d.cash_percentage);
            
            charts.portfolio = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [
                        {
                            label: 'è‚¡ç¥¨é…ç½® (%)',
                            data: equity,
                            borderColor: '#4CAF50',
                            backgroundColor: 'rgba(76, 175, 80, 0.1)',
                            borderWidth: 2,
                            fill: false,
                            tension: 0.1
                        },
                        {
                            label: 'å€ºåˆ¸é…ç½® (%)',
                            data: bonds,
                            borderColor: '#2196F3',
                            backgroundColor: 'rgba(33, 150, 243, 0.1)',
                            borderWidth: 2,
                            fill: false,
                            tension: 0.1
                        },
                        {
                            label: 'ç°é‡‘é…ç½® (%)',
                            data: cash,
                            borderColor: '#FF9800',
                            backgroundColor: 'rgba(255, 152, 0, 0.1)',
                            borderWidth: 2,
                            fill: false,
                            tension: 0.1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    }
                }
            });
        }
        
        function createInflationChart(data) {
            const ctx = document.getElementById('inflationChart').getContext('2d');
            const dates = data.map(d => d.date);
            const inflation = data.map(d => d.inflation_rate);
            
            charts.inflation = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [{
                        label: 'é€šèƒ€ç‡ (%)',
                        data: inflation,
                        borderColor: '#9C27B0',
                        backgroundColor: 'rgba(156, 39, 176, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }
        
        // æ›´æ–°å±æœºåˆ†æ
        function updateCrisisAnalysis(analysis) {
            const container = document.getElementById('crisisAnalysis');
            let html = '';
            
            if (analysis && analysis.rate_analysis) {
                Object.entries(analysis.rate_analysis).forEach(([period, data]) => {
                    const statusClass = data.percentage_change < -50 ? 'status-danger' : 
                                      data.percentage_change < -20 ? 'status-warning' : 'status-good';
                    
                    html += `
                        <div class="metric-card">
                            <h3 style="margin-bottom: 15px; color: #333;">${period}</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                <div>
                                    <div class="metric-value">${data.start_value}% â†’ ${data.end_value}%</div>
                                    <div class="metric-label">åˆ©ç‡å˜åŒ–</div>
                                </div>
                                <div>
                                    <div class="metric-value">${data.absolute_change > 0 ? '+' : ''}${data.absolute_change}%</div>
                                    <div class="metric-label">ç»å¯¹å˜åŒ–</div>
                                </div>
                                <div>
                                    <div class="metric-value">${data.volatility}%</div>
                                    <div class="metric-label">æœŸé—´æ³¢åŠ¨ç‡</div>
                                </div>
                            </div>
                            <div style="margin-top: 15px; padding: 10px; background: #f5f5f5; border-radius: 5px;">
                                <span class="status-indicator ${statusClass}"></span>
                                ç­–ç•¥å“åº”: é£é™©è§„é¿ä¸æµåŠ¨æ€§ç®¡ç†
                            </div>
                        </div>
                    `;
                });
            } else {
                html = '<div class="error-message">æš‚æ— å±æœºåˆ†ææ•°æ®</div>';
            }
            
            container.innerHTML = html;
        }
        
        // åˆ·æ–°æ‰€æœ‰æ•°æ®
        async function refreshAllData() {
            const btn = document.getElementById('refreshBtn');
            const originalText = btn.textContent;
            
            try {
                btn.textContent = 'â³ æ­£åœ¨åˆ·æ–°...';
                btn.disabled = true;
                
                // é‡æ–°åŠ è½½æ•°æ®
                await loadData();
                
                // æ›´æ–°å›¾è¡¨
                Object.values(charts).forEach(chart => chart.destroy());
                createCharts();
                
                // æ›´æ–°æ—¶é—´æˆ³
                updateLastUpdateTime();
                
                showMessage('âœ… æ•°æ®åˆ·æ–°æˆåŠŸï¼');
            } catch (error) {
                showError('åˆ·æ–°å¤±è´¥: ' + error.message);
            } finally {
                btn.textContent = originalText;
                btn.disabled = false;
            }
        }
        
        // å¯¼å‡ºåŠŸèƒ½
        function exportCurrentView() {
            const dataStr = JSON.stringify(window.financialData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `financial_dashboard_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showMessage('ğŸ“¤ æ•°æ®å¯¼å‡ºæˆåŠŸï¼');
        }
        
        // è‡ªåŠ¨åˆ·æ–°æ§åˆ¶
        function toggleAutoRefresh() {
            const statusEl = document.getElementById('autoRefreshStatus');
            
            if (autoRefreshEnabled) {
                clearInterval(autoRefreshInterval);
                autoRefreshEnabled = false;
                statusEl.textContent = 'å…³é—­';
                console.log('â¹ï¸ è‡ªåŠ¨åˆ·æ–°å·²åœæ­¢');
            } else {
                autoRefreshInterval = setInterval(refreshAllData, 300000); // 5åˆ†é’Ÿåˆ·æ–°ä¸€æ¬¡
                autoRefreshEnabled = true;
                statusEl.textContent = 'å¼€å¯';
                console.log('â–¶ï¸ è‡ªåŠ¨åˆ·æ–°å·²å¯åŠ¨ (5åˆ†é’Ÿé—´éš”)');
            }
        }
        
        // æ›´æ–°æ—¶é—´æˆ³
        function updateLastUpdateTime() {
            const now = new Date();
            document.getElementById('lastUpdate').textContent = 
                now.toLocaleString('zh-CN');
        }
        
        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(message) {
            // åˆ›å»ºä¸´æ—¶æ¶ˆæ¯æç¤º
            const msgEl = document.createElement('div');
            msgEl.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #4CAF50;
                color: white;
                padding: 15px 20px;
                border-radius: 5px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                animation: slideIn 0.3s ease;
            `;
            msgEl.textContent = message;
            
            document.body.appendChild(msgEl);
            
            setTimeout(() => {
                msgEl.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => document.body.removeChild(msgEl), 300);
            }, 3000);
        }
        
        // æ˜¾ç¤ºé”™è¯¯
        function showError(message) {
            console.error('âŒ é”™è¯¯:', message);
            const errorEl = document.createElement('div');
            errorEl.className = 'error-message';
            errorEl.textContent = message;
            errorEl.style.position = 'fixed';
            errorEl.style.top = '20px';
            errorEl.style.right = '20px';
            errorEl.style.zIndex = '1000';
            document.body.appendChild(errorEl);
            
            setTimeout(() => document.body.removeChild(errorEl), 5000);
        }
        
        // æ·»åŠ CSSåŠ¨ç”»
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initializeDashboard);
    </script>
</body>
</html>